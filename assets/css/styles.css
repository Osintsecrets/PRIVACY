:root{--bg:#0b0f14;--text:#e6faff;--muted:#a5cfd6;--accent:#00e6ff;--card:#0f141b;--border:#1f2a34;--radius:14px;--space:clamp(14px,3vw,22px);--font-sans:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";}
*{box-sizing:border-box;}
html{height:100%;scroll-behavior:smooth;}
body{height:100%;}
body{margin:0;background:var(--bg);color:var(--text);font:16px/1.6 var(--font-sans);}
a{color:var(--accent);}a:hover{text-decoration:underline;}
a:focus-visible{outline:2px solid var(--accent);outline-offset:3px;}
.wrapper{max-width:72ch;margin:0 auto;padding:calc(var(--space)*2) var(--space);}
header{position:sticky;top:0;z-index:var(--z-header,10);background:#0c1117;border-bottom:1px solid var(--border);}
.header-row{display:flex;align-items:center;justify-content:space-between;gap:var(--space);}
.brand{color:var(--text);text-decoration:none;font-weight:700;}
.menu-toggle{background:#0e1820;color:var(--text);border:1px solid var(--border);border-radius:10px;padding:10px 12px;min-width:44px;min-height:44px;}
.menu-toggle:focus-visible{outline:2px solid var(--accent);outline-offset:2px;}
.menu-container{position:relative;display:flex;align-items:center;}
.menu{display:flex;flex-direction:column;gap:6px;padding:12px;background:#0e151b;border:1px solid var(--border);border-radius:12px;position:absolute;top:calc(100% + 10px);right:0;width:min(240px,calc(100vw - var(--space)*2));box-shadow:0 18px 40px rgba(0,0,0,0.45);z-index:var(--z-menu,20);pointer-events:auto;}
.menu::before{content:"";position:absolute;top:-10px;right:18px;width:16px;height:16px;transform:rotate(45deg);background:#0e151b;border-left:1px solid var(--border);border-top:1px solid var(--border);z-index:19;}
.menu a{display:block;padding:10px 12px;border-radius:10px;color:var(--muted);text-decoration:none;position:relative;z-index:1;}
.menu a[aria-current="page"]{background:#0f1b20;color:var(--text);}
.menu a:focus-visible{outline:2px solid var(--accent);outline-offset:2px;}
.menu[hidden]{display:none;}
.menu[hidden]::before{display:none;}
.skip{position:absolute;left:-9999px;}
.skip:focus{left:var(--space);top:var(--space);background:#001519;padding:8px 10px;border-radius:8px;z-index:40;}
main{display:block;}
h1{font-size:clamp(28px,6vw,48px);line-height:1.15;margin:0 0 var(--space) 0;}
.lead{color:var(--muted);font-size:clamp(16px,3.6vw,18px);margin-bottom:var(--space);}
.button{display:inline-block;min-width:44px;min-height:44px;padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:#0e1820;color:var(--text);text-decoration:none;font-weight:600;}
.button.primary{background:#01252a;border-color:#07353a;}
.button:hover{background:#0f1f26;}
.button:focus-visible{outline:2px solid var(--accent);outline-offset:2px;}
.button-group{display:flex;flex-direction:column;gap:12px;}
@media (min-width:600px){.button-group{flex-direction:row;}}
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:var(--space);}
.install-card{display:flex;flex-direction:column;gap:calc(var(--space)*1.25);}
.install-header{display:flex;flex-direction:column;gap:8px;}
.install-layout{display:flex;flex-direction:column;gap:calc(var(--space)*1.25);}
.install-actions{display:flex;flex-direction:column;gap:12px;max-width:320px;}
.install-trigger[disabled]{opacity:0.6;cursor:not-allowed;}
.install-message{margin:0;color:var(--muted);font-size:0.95rem;}
.install-instructions h3{margin:0 0 0.5rem;font-size:1.05rem;}
.install-instructions ol{margin:0;padding-left:1.25rem;display:flex;flex-direction:column;gap:6px;}
.install-instructions li{line-height:1.5;}
.install-note{margin:0.75rem 0 0;color:var(--muted);font-size:0.95rem;}
@media (min-width:720px){
.install-layout{flex-direction:row;align-items:flex-start;gap:calc(var(--space)*2);}
.install-actions{flex:0 0 260px;}
.install-instructions{flex:1;}
}
section+section{margin-top:calc(var(--space)*1.5);}
.notice{border-left:4px solid var(--accent);padding:var(--space);border-radius:var(--radius);background:#0e151b;color:var(--muted);margin-bottom:calc(var(--space)*1.5);}
.details-list details{background:#0e151b;border:1px solid var(--border);border-radius:var(--radius);padding:var(--space);} 
.details-list details+details{margin-top:var(--space);}
summary{cursor:pointer;font-weight:600;}
summary:focus-visible{outline:2px solid var(--accent);outline-offset:2px;border-radius:10px;}
footer{border-top:1px solid var(--border);color:#85b6bd;background:#0c1117;}
footer .wrapper{padding-top:var(--space);padding-bottom:var(--space);font-size:0.9rem;}
.footer-layout{display:flex;flex-direction:column;gap:12px;}
.footer-links{display:flex;flex-wrap:wrap;gap:12px;}
.footer-links a{color:var(--muted);text-decoration:none;}
.footer-links a:hover{text-decoration:underline;}
.ethics-footer-note{margin:1rem 0 0 0;font-size:0.85rem;color:rgba(255,255,255,0.7);}
.ethics-footer-note a{color:inherit;font-weight:600;text-decoration:none;}
.ethics-footer-note a:hover{text-decoration:underline;}
:root[data-rm='on'] *,[data-rm='on'] *{transition:none!important;animation:none!important;}
.lead{ color:var(--muted); margin-bottom: var(--space); }
.grid{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: var(--space); }
@media (max-width: 599px){ .grid{ grid-template-columns: 1fr; } }
@media (min-width: 720px){ .grid{ grid-template-columns: repeat(3, minmax(0,1fr)); } }
.tile{ display:flex; align-items:center; justify-content:center; min-height: 100px; border:1px solid var(--border); border-radius: var(--radius); background: var(--card, #0f141b); color: var(--text); text-decoration:none; font-weight:600; }
.tile:hover{ background:#0f1b20; }
.tile:focus-visible{ outline:2px solid var(--accent); outline-offset:2px; }
.crumbs{ margin-bottom: var(--space); }
.crumb.back{ display:inline-block; padding:8px 10px; border-radius:10px; border:1px solid var(--border); background:#0e1820; color:var(--text); text-decoration:none; }
.crumb.back:focus-visible{ outline:2px solid var(--accent); outline-offset:2px; }
.breadcrumb{ display:flex; flex-wrap:wrap; gap:8px; align-items:center; font-size:0.95rem; color:var(--muted); margin-bottom:var(--space); }
.breadcrumb ol{ display:flex; flex-wrap:wrap; gap:8px; list-style:none; margin:0; padding:0; }
.breadcrumb ol li{ display:flex; align-items:center; gap:8px; }
.breadcrumb ol li+li::before{ content:'/'; color:var(--muted); }
.breadcrumb a{ color:var(--muted); text-decoration:none; }
.breadcrumb a:hover{ text-decoration:underline; }
.breadcrumb [aria-current="page"]{ color:var(--text); font-weight:600; }
.card h2 + .lead { margin-top: .5rem; }
.card details { margin-top: .75rem; }
.card details + details { margin-top: .5rem; }
.card ol { padding-left: 1.25rem; }
nav.card ol { padding-left: 1.25rem; }
.platform-page{background:var(--bg);}
.platform-wrapper{max-width:min(1200px,calc(100% - var(--space)*2));margin:0 auto;padding:calc(var(--space)*2) var(--space) var(--space);display:flex;flex-direction:column;gap:calc(var(--space)*1.5);}
.platform-header{display:flex;flex-direction:column;gap:8px;}
.guide-search{display:flex;flex-direction:column;gap:8px;}
.guide-search-label{font-weight:600;}
.guide-search-field{display:flex;gap:8px;align-items:center;}
.guide-search-field input{flex:1;min-height:44px;border-radius:var(--radius);border:1px solid var(--border);background:#0d161d;color:var(--text);padding:0 14px;font-size:1rem;}
.guide-search-field input::placeholder{color:var(--muted);}
.guide-search-field input:focus-visible{outline:2px solid var(--accent);outline-offset:2px;}
.guide-search-reset{min-height:44px;padding:0 16px;border-radius:var(--radius);border:1px solid var(--border);background:#0e1820;color:var(--text);font-weight:600;cursor:pointer;}
.guide-search-reset:hover{background:#102028;}
.guide-search-reset:focus-visible{outline:2px solid var(--accent);outline-offset:2px;}
.search-status{margin:0;font-size:0.95rem;color:var(--muted);}
.platform-layout{display:flex;flex-direction:column;gap:calc(var(--space)*1.5);}
.platform-content{display:flex;flex-direction:column;gap:calc(var(--space)*1.5);}
.category-browser{display:flex;flex-direction:column;gap:calc(var(--space)*1.5);}
.category-browser-grid{display:flex;flex-direction:column;gap:var(--space);}
.category-browser-grid .lead{color:var(--muted);margin:0;}
.category-grid{display:grid;gap:var(--space);grid-template-columns:repeat(auto-fit,minmax(180px,1fr));}
.category-tile{display:flex;align-items:center;justify-content:center;padding:1.5rem;border:1px solid var(--border);border-radius:var(--radius);background:#0d161d;color:var(--text);font-weight:600;min-height:120px;text-align:center;cursor:pointer;transition:transform 0.2s ease,border-color 0.2s ease,background 0.2s ease;}
.category-tile:hover,.category-tile:focus-visible{border-color:var(--accent);background:#102028;transform:translateY(-3px);outline:2px solid var(--accent);outline-offset:2px;}
.category-browser-detail{display:flex;flex-direction:column;gap:0.75rem;}
.category-browser-detail[hidden]{display:none!important;}
.category-back{align-self:flex-start;}
.category-detail-title{margin:0;}
.category-detail-count{margin:0;color:var(--muted);font-size:0.95rem;}
.platform-sidebar{position:relative;}
.platform-sidebar .sidebar-inner{display:flex;flex-direction:column;gap:var(--space);}
.platform-sidebar nav ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:6px;}
.platform-sidebar a{text-decoration:none;color:var(--muted);font-size:0.95rem;}
.platform-sidebar a:hover{color:var(--text);}
.platform-sidebar a:focus-visible{outline:2px solid var(--accent);outline-offset:2px;border-radius:8px;}
.platform-sidebar h2{margin:0;font-size:1.1rem;}
.toc-card{display:flex;flex-direction:column;gap:12px;}
.guide-index-card{display:flex;flex-direction:column;gap:12px;}
.guide-category-heading{margin:calc(var(--space)*1.75) 0 calc(var(--space)/2);font-size:clamp(22px,4vw,30px);line-height:1.2;}
.guide-category-heading:first-of-type{margin-top:calc(var(--space)*1.25);}
.guide-category-heading + .card{margin-top:var(--space);}
.guide-category-heading.is-hidden{display:none;}
#guide-index{display:flex;flex-direction:column;gap:12px;}
#guide-index .guide-category{background:#0e151b;border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;}
#guide-index .guide-category.is-hidden{display:none;}
#guide-index summary{list-style:none;padding:12px 16px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:12px;background:#101922;color:var(--muted);transition:color 0.2s ease,background 0.2s ease;}
#guide-index summary:hover{color:var(--text);background:#102028;}
#guide-index .guide-category[open] > summary{border-bottom:1px solid var(--border);color:var(--text);}
#guide-index summary::-webkit-details-marker{display:none;}
#guide-index summary::after{content:'▾';font-size:0.9rem;color:var(--muted);transition:transform 0.2s ease;}
#guide-index .guide-category[open] > summary::after{transform:rotate(180deg);}
#guide-index .guide-category-list{list-style:none;margin:0;padding:0 16px 16px 16px;display:flex;flex-direction:column;gap:8px;counter-reset:guide;}
#guide-index .guide-category-list > li{background:#0d161d;border:1px solid var(--border);border-radius:var(--radius);padding:12px 14px 12px 48px;transition:background 0.2s,border-color 0.2s;position:relative;counter-increment:guide;}
#guide-index .guide-category-list > li:hover{border-color:var(--accent);}
#guide-index .guide-category-list > li::before{content:counter(guide);position:absolute;left:14px;top:50%;transform:translateY(-50%);font-weight:700;color:var(--muted);font-size:0.95rem;}
#guide-index .guide-category-list > li a{text-decoration:none;color:var(--text);display:block;font-weight:600;}
#guide-index .guide-category-list > li a:hover{color:var(--accent);}
#guide-index .guide-category-list > li.is-hidden{display:none;}
.platform-content section.card{box-shadow:0 10px 30px rgba(0,0,0,0.35);}
.platform-content section.card.is-hidden{display:none;}
.platform-content section.card mark,#guide-index mark,nav.card mark{background:rgba(0,230,255,0.2);color:var(--text);padding:0 2px;border-radius:4px;}
.back-to-top{align-self:flex-end;position:fixed;bottom:24px;right:24px;background:#0e1820;border:1px solid var(--border);color:var(--text);padding:10px 16px;border-radius:var(--radius);text-decoration:none;font-weight:600;box-shadow:0 15px 35px rgba(0,0,0,0.45);transition:opacity 0.2s ease,transform 0.2s ease;z-index:60;}
.back-to-top.is-hidden{opacity:0;pointer-events:none;transform:translateY(10px);}
.back-to-top:focus-visible{outline:2px solid var(--accent);outline-offset:2px;}
.search-empty-message{background:#0f1a22;border:1px dashed var(--border);border-radius:var(--radius);padding:calc(var(--space)*0.75);color:var(--muted);font-size:0.95rem;}
.search-empty-message[hidden]{display:none;}
.is-hidden{display:none!important;}
@media (min-width:960px){
.platform-layout{flex-direction:row;align-items:flex-start;gap:calc(var(--space)*2);}
.platform-content{flex:1 1 auto;}
.platform-sidebar{width:260px;}
.platform-sidebar .sidebar-inner{position:sticky;top:calc(var(--space)*2 + 80px);}
#guide-index{max-height:calc(100vh - 240px);overflow:auto;padding-right:6px;}
}
@media (max-width:600px){
.guide-search-field{flex-direction:column;align-items:stretch;}
.guide-search-reset{width:100%;}
.back-to-top{right:16px;bottom:16px;}
}
:root {
  --z-overlay: 2000;   /* page-dimming overlay */
  --z-header: 2500;    /* sticky header and its children */
  --z-menu: 2600;      /* header dropdown menu (inside header) */
  --z-dialog: 3000;    /* modal dialogs */
}

/* Header sits above overlay so dropdown is clickable */
header { position: sticky; top: 0; z-index: var(--z-header); }

/* Menu is within header; ensure it is on top of the header layer */
.menu-container { position: relative; isolation: isolate; }
.menu {
  position: absolute;
  top: calc(100% + 10px);
  right: 0;
  z-index: var(--z-menu);
  pointer-events: auto;
}

/* Overlay below header/menu, above rest of page */
#ui-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.55);
  z-index: var(--z-overlay);
  opacity: 0;
  pointer-events: none;
  transition: opacity .15s ease;
}
#ui-overlay[aria-hidden="false"] { opacity: 1; pointer-events: auto; }

/* Lock background scroll while menu/dialog open */
body.is-locked { overflow: hidden; position: relative; touch-action: none; }

/* Dialogs stay top-most */
dialog {
  z-index: var(--z-dialog);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 1rem 1.25rem;
  background: var(--card);
  color: var(--text);
  max-width: min(680px, 90vw);
  box-shadow: 0 24px 60px rgba(0,0,0,.5);
}
dialog::backdrop { background: rgba(0,0,0,.5); }
dialog article { display: flex; flex-direction: column; gap: 16px; }
dialog h2 { margin: 0; font-size: clamp(20px, 3.6vw, 28px); }
dialog p { margin: 0; color: var(--muted); font-size: 1.05rem; }
.button-group { display: flex; gap: 12px; flex-wrap: wrap; }

/* ---- Pledge badge (pill) visibility & contrast ---- */
.pill { display:inline-flex; align-items:center; gap:.35rem; padding:.35rem .7rem; border:1px solid var(--border); border-radius:999px; font-weight:600; line-height:1; }
#pledgeStatus.pill { background: var(--card); color: var(--text); box-shadow: 0 2px 6px rgba(0,0,0,.18); }
@media (max-width: 420px){ #pledgeStatus.pill { font-size:.85rem; } }

/* Optional: nicer hover focus for menu items */
#site-menu a { padding:10px 12px; border-radius:10px; }
#site-menu a:hover, #site-menu a:focus-visible { background:#0f1f26; }

/* RTL alignment for dropdown */
html[dir="rtl"] .menu { right:auto; left:0; }

/* Extra header stacking guard */
.header-row { position: relative; z-index: calc(var(--z-header) + 1); }

/* Pledge pill states */
:root { --ok:#2fb171; --warn:#e6a700; }
#pledgeStatus.pill { background: var(--card); color: var(--text); box-shadow: 0 2px 6px rgba(0,0,0,.18); font-weight:700; }
#pledgeStatus.pill.is-ok { border-color: color-mix(in lab, var(--ok) 60%, var(--border)); color: var(--ok); }
#pledgeStatus.pill.is-warn { border-color: color-mix(in lab, var(--warn) 60%, var(--border)); color: var(--warn); }


/* — Language select styling — */
.select {
  appearance: none; -webkit-appearance: none; -moz-appearance: none;
  background: var(--card);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 10px 38px 10px 12px; /* room for chevron */
  min-height: 44px; line-height: 1.1; font-weight: 600;
  box-shadow: 0 2px 8px rgba(0,0,0,.18) inset, 0 1px 2px rgba(0,0,0,.05);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23a8c4cc' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat; background-position: right 12px center; background-size: 14px;
}
.select:focus { outline: 2px solid var(--accent); outline-offset: 2px; }
.select:hover { border-color: #3a5e66; }

/* Option panel colors (most browsers) */
select option { background: var(--card); color: var(--text); }

/* RTL: chevron on the left */
html[dir="rtl"] .select { padding: 10px 12px 10px 38px; background-position: left 12px center; }


/* Mission cards & checklists (shared) */
.cards, .missions { gap: 12px; }
.mission .button.primary { background: #174f3c; border:1px solid #25795b; }
.mission .button.primary:hover { background:#1a5e46; }
.mission .button { background:#0f1f26; border:1px solid var(--border); }

/* Print-friendly tweak for self-audit */
@media print {
  header, footer, .toolbar, #ui-overlay { display:none !important; }
  .mission { break-inside: avoid; box-shadow:none; border-color:#b8cbd0; }
  .progress { display:none; }
}

/* HUD */
.hud { display:flex; gap:12px; align-items:center; margin:10px 0 16px; }
.hud-item { display:flex; align-items:center; gap:6px; padding:8px 10px; border:1px solid var(--border); border-radius:10px; background:var(--card); box-shadow:0 2px 8px rgba(0,0,0,.18); }
.hud-item .label { font-size:.8rem; color:var(--muted); text-transform:uppercase; letter-spacing:.06em; }
.hud-item .value { font-weight:800; font-variant-numeric:tabular-nums; }

/* Mission header progress accent (visual feedback per phase) */
.mission { position:relative; }
.mission::before { content:""; position:absolute; inset:0 0 auto 0; height:4px; background:linear-gradient(90deg,#2fb171,#53d1a0); width:var(--phase-pct,0%); border-top-left-radius:10px; border-top-right-radius:10px; }

/* Locked state (for linear mode) */
.mission.is-locked { opacity:.55; filter:saturate(.7); }
.mission.is-locked .quest, .mission.is-locked .actions, .mission.is-locked .note { pointer-events:none; }

/* Achievements */
.achievements { margin-top:24px; }
.ach-list { display:grid; gap:6px; grid-template-columns:1fr; }
@media(min-width:560px){ .ach-list{ grid-template-columns:repeat(2, minmax(0,1fr)); } }
.ach-list li { list-style:none; padding:8px 10px; border:1px solid var(--border); border-radius:10px; background:var(--card); box-shadow:0 2px 8px rgba(0,0,0,.12); }
